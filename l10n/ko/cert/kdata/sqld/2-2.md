
# 2과목 2장 (Subject 2 - Chapter 2)

* **2과목: SQL 기본 및 활용**
  * **2장: SQL 활용**
    * 1절: 표준조인
    * 2절: 집합연산자
    * 3절: 계층형 질의
    * 4절: 서브쿼리
    * 5절: 그룹 함수
    * 6절: 윈도우 함수
    * 7절: DCL
    * 8절: 절차형 SQL

## 표준조인

조인 중에서 표준적인 조인 연산.

* INNER JOIN (내부 조인)
  * OUTER JOIN과 대비되는 개념
  * JOIN 조건에서 동일한 값이 있는 행만 반환
  * INNER JOIN 표시는 JOIN 조건을 FROM 절에서 정의하겠다는 표시임
  * 따라서 USING 조건절이나 ON 조건절을 필수적으로 사용해야 함
  * INNER는 SQL문 내에서 생략 가능
  * USING 조건절: 같은 이름을 가진 컬럼 중 원하는 컬럼만 사용 가능
  * ON 조건절: 칼럼명이 다르더라도 JOIN 조건을 사용할 수 있음
* NATURAL JOIN
  * 두 테이블 간의 동일한 이름을 갖는 모든 칼럼들에 대해 EQUI JOIN 수행
  * NATURAL JOIN이 명시되면 추가로 USING 조건절, ON 조건절, WHERE 절에서 JOIN 조건을 정의할 수 없음
* CROSS JOIN
  * 테이블 간 JOIN 조건이 없는 경우 생길 수 있는 모든 데이터의 조합을 출력함
  * CARTESIAN PRODUCT와 같은 개념임
* OUTER JOIN
  * INNER JOIN과 대비되는 개념
  * JOIN 조건에서 동일한 값이 없는 행도 반환할 때 사용 가능
  * OUTER JOIN 또한 JOIN 조건을 FROM 절에서 정의하겠다는 표시임
  * 따라서 USING 조건절이나 ON 조건절 필수적으로 사용해야 함
* LEFT OUTER JOIN
  * 먼저 표기된 좌측 테이블에 해당하는 데이터를 먼저 읽음
  * 이후 나중에 표기된 우측 테이블에서 JOIN 대상 데이터를 읽어옴
  * OUTER 생략하여 LEFT JOIN으로 사용 가능
* RIGHT OUTER JOIN
  * 나중에 표기된 우측 테이블에 해당하는 데이터를 먼저 읽음
  * 이후 먼저 표기된 좌측 테이블에서 JOIN 대상 데이터를 읽어옴
  * OUTER 생략하여 RIGHT JOIN으로 사용 가능
* FULL OUTER JOIN
  * 조인 수행 시 좌측 우측 테이블의 모든 데이터를 읽어 JOIN
  * OUTER 생략하여 FULL JOIN으로 사용 가능

## 집합연산자

* 두 개 이상의 테이블에서 조인을 사용하지 않고 연관된 데이터를 조회할 때 사용
  * 테이블의 자료를 컬럼 기준으로 합침.
  * 즉 집합 연산자는 2개 이상의 SELECT 문을 연결하는 것.
* SELECT 절의 칼럼 수가 동일하고 SELECT 절의 동일 위치에 존재하는 칼럼의 데이터 타입이 같을 때 사용 가능.
* 집합 연산자는 사용상의 제약 조건을 만족한다면 어떤 형태의 SELECT 문이라도 이용할 수 있음.
  * ORDER BY는 집합 연산을 적용한 최종 결과에 대한 정렬 처리이므로 가장 마지막 줄에 한번만 기술함.

## 집합연산자 종류

* UNION
  * 여러 개의 SQL문 결과에 대한 합집합
  * 결과에서 모든 중복된 행은 하나로 합쳐짐
* UNION ALL
  * 중복된 행도 그대로 결과에 표시됨
  * 즉 단순히 결과만 합쳐놓은 것
  * 중복된 행이 없는 경우 결과는 UNION과 동일함
  * 중복을 배제한 게 필요한 경우가 아니라면 UNION ALL을 우선적으로 사용
* INTERSECT
  * 여러 개의 SQL문 결과에 대한 교집합
* EXCEPT(MINUS)
  * 앞의 SQL문의 결과에서 뒤의 SQL문 결과에 대한 차집합
  * 중복된 행은 하나로 만듦
  * ORACLE의 경우 MINUS로 사용

## 계층형 질의 (Hierarchical Query)

* 테이블에 계층형 데이터가 존재하는 경우 데이터를 조회하기 위해 계층형 질의 사용
* 계층형 데이터: 동일 테이블에 계층적으로 상위와 하위 데이터가 포함된 데이터를 말함

## 서브쿼리

* 하나의 SQL문 안에 포함되어 있는 또 다른 SQL문을 말함
* 즉 서브쿼리가 메인쿼리에 포함되는 종속적인 관계

반환되는 데이터 형태에 따른 서브쿼리 종류:

* 단일행 서브쿼리
  * 서브쿼리의 실행 결과가 항상 1건 이하인 서브쿼리를 의미
  * 단일행 서브쿼리는 비교연산자와 함께 사용됨
* 다중행 서브쿼리
  * 서브쿼리의 실행결과가 여러 건인 서브쿼리를 의미
  * 다중행 비교연산자와 함께 사용
  * 다중행 비교연산자: IN, ANY, SOME, EXISTS
* 다중칼럼 서브쿼리
  * 서브쿼리의 실행결과로 여러 칼럼을 반환
  * 메인쿼리의 조건절에 여러 칼럼을 동시에 비교할 수 있음

동작하는 방식에 따른 서브쿼리 종류

* 비연관 서브쿼리
  * 서브쿼리가 메인쿼리의 칼럼을 가지고 있지 않은 형태의 서브쿼리
  * 메인쿼리에 값을 제공하기 위한 목적으로 주로 사용
* 연관 서브쿼리
  * 서브쿼리가 메인쿼리의 칼럼을 사용하는 형태의 서브쿼리
  * 일반적으로 메인쿼리에서 먼저 읽은 데이터를 서브쿼리에서 조건이 맞는지 확인하는 용도로 사용

## 그룹 함수

데이터 분석을 위한 세 가지 함수가 있다. 그룹 함수는 그중 하나다.

* 집계 함수
  * 그룹 함수의 한 부분
  * COUNT, SUM, AVG, MAX, MIN 등
* 그룹 함수
  * 집계 함수를 제외하면 ROLLUP, CUBE, GROUPING SETS 함수 등이 존재
* 윈도우 함수
  * 데이터 웨어하우스에서 발전한 기능이며 분석함수, 순위함수로도 알려져 있음

## 윈도우 함수

역시 데이터 분석 함수 중 하나.

* 순위 관련 함수
  * RANK 함수
  * DENSE_RANK 함수
  * ROW_NUMBER 함수
* 집계 관련 함수
  * MAX 함수
  * SUM 함수
  * AVG 함수
  * COUNT 함수
* 기타
  * 그룹 내 행순서 관련 (ORACLE에만 존재)
    * FIRST_VALUE, LAST_VALUE, LAG, HEAD
  * 그룹 내 비율 관련 함수
    * CUME_DIST, PERCENT_RANK 함수 (대부분의 DBMS)
    * NTILE (ORACLE, SQL SERVER)

## DCL

* 시스템 권한 (GRANT, REVOKE)
  * 사용자가 SQL문을 실행하기 위해 필요한 적절한 권한
* SESSION 생성 권한 (CREATE SESSION 권한)
* TABLE 생성 권한 (CREATE TABLE 권한)
* 오브젝트 권한 (SELECT, INSERT, DELETE, UPDATE 권한)
  * 테이블, 뷰 등의 오브젝트에 대해 접근할 수 있는 권한
* ROLE
  * 여러 유저에게 권한을 한번에 부여하기 위해 사용하는 개념

## 절차형 SQL (Procedural SQL)

* SQL문의 연속적인 실행이나 조건에 따른 분기처리를 이용하여 특정 기능을 수행하는 저장 모듈 생성 가능
* 저장 모듈: PL/SQL 문장을 DB 서버에 저장하여 사용자와 어플리케이션 사이에서 공유할 수 있도록 만든 일종의 SQL 컴포넌트 프로그램
* 프로시저(PROCEDURE): DB에 대한 일련의 작업을 정리한 절차를 DBMS에 저장한 것
* 사용자 정의 함수(User Defined Function): 프로시저와 비슷하나 반드시 수행에 대한 결과값을 리턴함
